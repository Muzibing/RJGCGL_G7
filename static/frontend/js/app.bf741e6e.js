(function(){"use strict";var e={5238:function(e,s,t){var n=t(5130),a=t(6768),o=t(4232);const i={id:"app"},r={class:"main-container"},u={class:"sidebar"},c=["onClick"];function h(e,s,t,n,h,l){const d=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("nav",null,[(0,a.Lk)("button",{onClick:s[0]||(s[0]=(...e)=>l.startNewChat&&l.startNewChat(...e))},"新建聊天")]),(0,a.Lk)("div",r,[(0,a.Lk)("aside",u,[s[1]||(s[1]=(0,a.Lk)("h2",null,"历史对话记录",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(h.chatHistory,((e,s)=>((0,a.uX)(),(0,a.CE)("li",{key:s},[(0,a.Lk)("button",{onClick:e=>l.loadChatHistory(s)},"对话 "+(0,o.v_)(s+1),9,c)])))),128))])]),((0,a.uX)(),(0,a.Wv)(d,{key:h.activeChatIndex,messages:l.activeMessages,onUpdateMessages:l.updateMessages},null,8,["messages","onUpdateMessages"]))])])}t(4114);var l={data(){return{chatHistory:[[]],activeChatIndex:0,isLoggedIn:!1,username:""}},provide(){return{isLoggedIn:this.isLoggedIn,username:this.username,setLogin:this.setLogin}},computed:{activeMessages(){return this.chatHistory[this.activeChatIndex]}},methods:{setLogin(e,s=""){this.isLoggedIn=e,this.username=s},startNewChat(){this.chatHistory[this.activeChatIndex].length>0&&(this.chatHistory[this.activeChatIndex]=[...this.activeMessages]),this.chatHistory.push([]),this.activeChatIndex=this.chatHistory.length-1},loadChatHistory(e){this.activeChatIndex=e},updateMessages(e){this.activeChatIndex>=0&&(this.chatHistory[this.activeChatIndex]=e)}}},d=t(1241);const g=(0,d.A)(l,[["render",h]]);var p=g,m=t(973);const v={class:"home-page"},f={class:"header-content"},k={key:0},L={key:1},y={class:"chat-container"},C=["src"],b={class:"message-content"},w={class:"input-container"};function I(e,s,t,i,r,u){const c=(0,a.g2)("HealthInfo");return(0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("header",null,[(0,a.Lk)("div",f,[i.isLoggedIn?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("span",null,"欢迎，"+(0,o.v_)(i.username),1),(0,a.Lk)("button",{onClick:s[0]||(s[0]=(...e)=>i.logout&&i.logout(...e))},"退出")])):((0,a.uX)(),(0,a.CE)("div",L,[s[6]||(s[6]=(0,a.Lk)("span",null,"未登录",-1)),(0,a.Lk)("button",{onClick:s[1]||(s[1]=(...e)=>i.navigateToLogin&&i.navigateToLogin(...e))},"登录"),(0,a.Lk)("button",{onClick:s[2]||(s[2]=(...e)=>i.navigateToRegister&&i.navigateToRegister(...e))},"注册")]))])]),s[7]||(s[7]=(0,a.Lk)("h1",null,"AI辅助就医问诊引擎",-1)),i.isLoggedIn?((0,a.uX)(),(0,a.Wv)(c,{key:0})):(0,a.Q3)("",!0),(0,a.Lk)("div",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.internalMessages,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:(0,o.C4)(["chat-message",e.sender])},[(0,a.Lk)("img",{src:e.avatar,class:"avatar"},null,8,C),(0,a.Lk)("div",b,(0,o.v_)(e.text),1)],2)))),128))]),(0,a.Lk)("div",w,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>r.userInput=e),onKeyup:s[4]||(s[4]=(0,n.jR)(((...e)=>u.sendMessage&&u.sendMessage(...e)),["enter"])),placeholder:"请输入您的问题..."},null,544),[[n.Jo,r.userInput]]),(0,a.Lk)("button",{onClick:s[5]||(s[5]=(...e)=>u.sendMessage&&u.sendMessage(...e))},"发送")])])}const T={class:"health-info"},x={key:0,class:"success"};function H(e,s,t,i,r,u){return(0,a.uX)(),(0,a.CE)("div",T,[s[3]||(s[3]=(0,a.Lk)("h2",null,"用户健康信息",-1)),(0,a.Lk)("form",{onSubmit:s[1]||(s[1]=(0,n.D$)(((...e)=>u.saveHealthInfo&&u.saveHealthInfo(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.healthInfo=e),placeholder:"请输入您的健康信息...",rows:"4"},null,512),[[n.Jo,r.healthInfo]]),s[2]||(s[2]=(0,a.Lk)("button",{type:"submit"},"保存",-1))],32),r.message?((0,a.uX)(),(0,a.CE)("p",x,(0,o.v_)(r.message),1)):(0,a.Q3)("",!0)])}var M={data(){return{healthInfo:"",message:""}},methods:{saveHealthInfo(){fetch("http://127.0.0.1:8000/api/health-info/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.$parent.username,healthInfo:this.healthInfo})}).then((e=>e.json())).then((e=>{e.success?this.message="健康信息保存成功":this.message="保存失败，请重试"})).catch((()=>{this.message="保存失败，请检查网络"}))}}};const E=(0,d.A)(M,[["render",H]]);var O=E,X={props:["messages"],components:{HealthInfo:O},setup(){const e=(0,a.WQ)("isLoggedIn",!1),s=(0,a.WQ)("username",""),t=(0,a.WQ)("setLogin"),n=()=>{window.location.href="/login"},o=()=>{window.location.href="/register"},i=()=>{t(!1,""),window.location.reload()};return{isLoggedIn:e,username:s,navigateToLogin:n,navigateToRegister:o,logout:i}},data(){return{internalMessages:[],userInput:""}},watch:{messages:{immediate:!0,handler(e){this.internalMessages=[...e]}}},methods:{sendMessage(){if(this.userInput.trim()){const e={text:this.userInput,sender:"user",avatar:"../maomaochong.jpg"};this.internalMessages.push(e),this.userInput="",setTimeout((()=>{const s={text:`这是对“${e.text}”的自动回复。`,sender:"bot",avatar:"../maomaochong.jpg"};this.internalMessages.push(s),this.$emit("update-messages",this.internalMessages)}),1e3)}}}};const j=(0,d.A)(X,[["render",I]]);var P=j;const $={class:"auth-page"};function J(e,s,t,i,r,u){return(0,a.uX)(),(0,a.CE)("div",$,[s[7]||(s[7]=(0,a.Lk)("h1",null,"AI辅助就医问诊引擎",-1)),s[8]||(s[8]=(0,a.Lk)("h2",null,"登录",-1)),(0,a.Lk)("form",{onSubmit:s[2]||(s[2]=(0,n.D$)(((...e)=>u.login&&u.login(...e)),["prevent"])),class:"auth-form"},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.username=e),type:"text",placeholder:"用户名",required:""},null,512),[[n.Jo,r.username]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>r.password=e),type:"password",placeholder:"密码",required:""},null,512),[[n.Jo,r.password]]),s[5]||(s[5]=(0,a.Lk)("button",{type:"submit"},"登录",-1))],32),(0,a.Lk)("p",null,[s[6]||(s[6]=(0,a.eW)(" 没有账号？")),(0,a.Lk)("button",{onClick:s[3]||(s[3]=(...e)=>u.navigateToRegister&&u.navigateToRegister(...e))},"注册")]),(0,a.Lk)("p",null,[(0,a.Lk)("button",{class:"back-btn",onClick:s[4]||(s[4]=(...e)=>u.navigateToHome&&u.navigateToHome(...e))},"返回主页")]),r.message?((0,a.uX)(),(0,a.CE)("p",{key:0,class:(0,o.C4)({success:r.success,error:!r.success})},(0,o.v_)(r.message),3)):(0,a.Q3)("",!0)])}var _={data(){return{username:"",password:"",message:"",success:!1}},methods:{login(){fetch("http://127.0.0.1:8000/api/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{e.success?(this.message="登录成功",this.success=!0,this.$router.push("/")):(this.message=e.message,this.success=!1)})).catch((()=>{this.message="登录失败，请重试",this.success=!1}))},navigateToRegister(){this.$router.push("/register")},navigateToHome(){this.$router.push("/")}}};const A=(0,d.A)(_,[["render",J]]);var S=A;const U={class:"auth-page"};function R(e,s,t,i,r,u){return(0,a.uX)(),(0,a.CE)("div",U,[s[7]||(s[7]=(0,a.Lk)("h1",null,"AI辅助就医问诊引擎",-1)),s[8]||(s[8]=(0,a.Lk)("h2",null,"注册",-1)),(0,a.Lk)("form",{onSubmit:s[3]||(s[3]=(0,n.D$)(((...e)=>u.register&&u.register(...e)),["prevent"])),class:"auth-form"},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.username=e),type:"text",placeholder:"用户名",required:""},null,512),[[n.Jo,r.username]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>r.password=e),type:"password",placeholder:"密码（至少6个字符）",required:""},null,512),[[n.Jo,r.password]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>r.confirmPassword=e),type:"password",placeholder:"确认密码",required:""},null,512),[[n.Jo,r.confirmPassword]]),s[5]||(s[5]=(0,a.Lk)("button",{type:"submit"},"注册",-1))],32),(0,a.Lk)("p",null,[s[6]||(s[6]=(0,a.eW)(" 已有账号？")),(0,a.Lk)("button",{onClick:s[4]||(s[4]=(...e)=>u.navigateToLogin&&u.navigateToLogin(...e))},"登录")]),r.message?((0,a.uX)(),(0,a.CE)("p",{key:0,class:(0,o.C4)({success:r.success,error:!r.success})},(0,o.v_)(r.message),3)):(0,a.Q3)("",!0)])}var Q={data(){return{username:"",password:"",confirmPassword:"",message:"",success:!1}},methods:{register(){return this.password.length<6?(this.message="密码不能少于6个字符",void(this.success=!1)):this.password!==this.confirmPassword?(this.message="两次密码不一致",void(this.success=!1)):void fetch("http://127.0.0.1:8000/api/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{e.success?(this.message="注册成功，请登录",this.success=!0,this.$router.push("/login")):(this.message=e.message,this.success=!1)})).catch((()=>{this.message="注册失败，请重试",this.success=!1}))},navigateToLogin(){this.$router.push("/login")}}};const V=(0,d.A)(Q,[["render",R]]);var W=V;const N=[{path:"/",name:"HomePage",component:P},{path:"/login",name:"LoginPage",component:S},{path:"/register",name:"RegisterPage",component:W},{path:"/health-info",name:"Health-info",component:O}],q=(0,m.aE)({history:(0,m.LA)(),routes:N});var D=q;const F=(0,n.Ef)(p);F.use(D),F.mount("#app")}},s={};function t(n){var a=s[n];if(void 0!==a)return a.exports;var o=s[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(s,n,a,o){if(!n){var i=1/0;for(h=0;h<e.length;h++){n=e[h][0],a=e[h][1],o=e[h][2];for(var r=!0,u=0;u<n.length;u++)(!1&o||i>=o)&&Object.keys(t.O).every((function(e){return t.O[e](n[u])}))?n.splice(u--,1):(r=!1,o<i&&(i=o));if(r){e.splice(h--,1);var c=a();void 0!==c&&(s=c)}}return s}o=o||0;for(var h=e.length;h>0&&e[h-1][2]>o;h--)e[h]=e[h-1];e[h]=[n,a,o]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={524:0};t.O.j=function(s){return 0===e[s]};var s=function(s,n){var a,o,i=n[0],r=n[1],u=n[2],c=0;if(i.some((function(s){return 0!==e[s]}))){for(a in r)t.o(r,a)&&(t.m[a]=r[a]);if(u)var h=u(t)}for(s&&s(n);c<i.length;c++)o=i[c],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(h)},n=self["webpackChunkvue_frontend"]=self["webpackChunkvue_frontend"]||[];n.forEach(s.bind(null,0)),n.push=s.bind(null,n.push.bind(n))}();var n=t.O(void 0,[504],(function(){return t(5238)}));n=t.O(n)})();
//# sourceMappingURL=app.bf741e6e.js.map